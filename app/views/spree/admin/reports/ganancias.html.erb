<%content_for :page_title do%>
	Ganancias del Ãºltimo mes
<%end%>
<script src="/assets/highcharts.js" type="text/javascript"></script>
<div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
<div id="container2" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
<div id="container3" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
<script>
$(function () {
        $('#container').highcharts({
            chart: {
                type: 'column',
                zoomType: 'x'
            },
            title: {
                text: 'Ganancias por clientes por Mes'
            },
            xAxis: {
                categories: <%=raw @months%>
            },
            yAxis: {
                min: 0,
                title: {
                    text: '$'
                }
            },
            tooltip: {
                headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
            series: <%=raw @series%>
        });
        $('#container2').highcharts({
            chart: {
                type: 'column',
                zoomType: 'x'
            },
            title: {
                text: 'Ganancias Clientes TOP 10'
            },
            xAxis: {
                categories: <%=raw @idClientes%>
            },
            yAxis: {
                min: 0,
                title: {
                    text: '$'
                }
            },
            tooltip: {
                headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
            series: <%=raw @gananciasClientes%>
        });
        $('#container3').highcharts({
            chart: {
                type: 'column',
                zoomType: 'x'
            },
            title: {
                text: 'Ganancias Productos TOP 10'
            },
            xAxis: {
                categories: <%=raw @skuProductos%>
            },
            yAxis: {
                min: 0,
                title: {
                    text: '$'
                }
            },
            tooltip: {
                headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
            series: <%=raw @gananciasProductos%>
        });
    });
</script>
<%content_for :page_actions do%>
	<li><%link_to_with_icon 'icon-arrow-left', Spree.t(:back_to_reports_list), spree.admin_reports_url, :class=>'button'%></li>
<%end%>

<h1>Resumen</h1>
<h2>Total de utilidades: <b>$ <%= @qqq[:sum]%></b></h2>
<br><br>
<h1>Ganancias por producto</h1>
<table>
	<tr>
		<td>SKU</td>
		<td>Ganancias</td>
	</tr>
	<tr>
		<% @q.each do |c|%>
		<td><%= c._id %></td>
		<td><%= c.sum_utilidades %></td>
		<% end %>
	</tr>
</table>


<br>
<br><h1>Ganancias por cliente</h1>
<table>
	<tr>
		<td>RUT cliente</td>
		<td>Ganancias</td>
	</tr>
	<tr>
		<% @qq.each do |c|%>
		<td><%= c._id %></td>
		<td><%= c.sum_utilidades %></td>
		<% end %>
	</tr>
</table>

